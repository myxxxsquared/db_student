<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>上机实习之Cassandra篇</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
<style type="text/css">

#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}</style>
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="l996" id="上机实习之cassandra篇">上机实习之Cassandra篇</h1><p data-anchor-id="jva8"><code>大数据管理技术</code> <code>NoSQL</code> <code>Cassandra</code></p><hr><div class="md-section-divider"></div><h2 data-anchor-id="ybq8" id="目录"><i class="icon-list"></i> <strong>目录</strong></h2><p data-anchor-id="mn2i"><div class="toc">
<ul>
<li><a href="#上机实习之cassandra篇">上机实习之Cassandra篇</a><ul>
<li><a href="#目录"> 目录</a></li>
<li><a href="#cassandra的安装"> Cassandra的安装</a><ul>
<li><a href="#warning">Warning</a></li>
<li><a href="#linux环境">Linux环境</a></li>
<li><a href="#windows环境">Windows环境</a></li>
</ul>
</li>
<li><a href="#cassandra的使用"> Cassandra的使用</a><ul>
<li><a href="#键空间操作">键空间操作</a></li>
<li><a href="#表操作">表操作</a></li>
<li><a href="#数据操作">数据操作</a></li>
</ul>
</li>
<li><a href="#java中使用cassandra"> Java中使用Cassandra</a></li>
<li><a href="#python中使用cassandra"> Python中使用Cassandra</a></li>
</ul>
</li>
</ul>
</div>
</p><hr><div class="md-section-divider"></div><h2 data-anchor-id="zk25" id="cassandra的安装"><i class="icon-gear"></i> <strong>Cassandra的安装</strong></h2><div class="md-section-divider"></div><h3 data-anchor-id="goue" id="warning">Warning</h3><p data-anchor-id="h6qs"><strong>Cassandra需要jdk1.8及python2.7环境支持，请确保环境版本的正确性。</strong></p><div class="md-section-divider"></div><h3 data-anchor-id="x75d" id="linux环境">Linux环境</h3><p data-anchor-id="gm36">1.下载安装包并解压</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="nm3j"><ol class="linenums"><li class="L0"><code><span class="pln">wget http</span><span class="pun">:</span><span class="com">//archive.apache.org/dist/cassandra/3.9/apache-cassandra-3.9-bin.tar.gz</span></code></li><li class="L1"><code><span class="pln">tar </span><span class="pun">-</span><span class="pln">zxvf apache</span><span class="pun">-</span><span class="pln">cassandra</span><span class="pun">-</span><span class="lit">3.9</span></code></li></ol></pre><p data-anchor-id="o6y8">2.启动Cassandra服务</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="sqi9"><ol class="linenums"><li class="L0"><code><span class="pln">cd apache</span><span class="pun">-</span><span class="pln">cassandra</span><span class="pun">-</span><span class="lit">3.9</span></code></li><li class="L1"><code><span class="pln">cd bin</span></code></li><li class="L2"><code><span class="pln">cassandra </span><span class="pun">-</span><span class="pln">f</span></code></li></ol></pre><p data-anchor-id="eg4s">3.打开另一个终端,连接至Cassandra</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="76q3"><ol class="linenums"><li class="L0"><code><span class="pln">cd apache</span><span class="pun">-</span><span class="pln">cassandra</span><span class="pun">-</span><span class="lit">3.9</span></code></li><li class="L1"><code><span class="pln">cd bin</span></code></li><li class="L2"><code><span class="pln">cqlsh</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="t07g" id="windows环境">Windows环境</h3><p data-anchor-id="xzco">1.下载安装包。 <a href="http://archive.apache.org/dist/cassandra/3.9/apache-cassandra-3.9-bin.tar.gz" target="_blank">官网下载地址</a> <br>
2.解压压缩包，并移动至指定目录(例如 D:\Cassandra) <br>
3.打开命令行窗口，启动Cassandra服务</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="jg4a"><ol class="linenums"><li class="L0"><code><span class="pln">C</span><span class="pun">:</span><span class="pln">\Users\MSI</span><span class="pun">&gt;</span><span class="pln"> D</span><span class="pun">:</span></code></li><li class="L1"><code><span class="pln">D</span><span class="pun">:</span><span class="pln">\&gt; cd D</span><span class="pun">:</span><span class="pln">\Cassandra\b</span><span class="kwd">in</span><span class="pln">\</span></code></li><li class="L2"><code><span class="pln">D</span><span class="pun">:</span><span class="pln">\Workers\Cassandra\b</span><span class="kwd">in</span><span class="pun">&gt;</span><span class="pln"> cassandra </span><span class="pun">-</span><span class="pln">f</span></code></li></ol></pre><p data-anchor-id="i9qt">4.打开另一个命令行窗口，连接至Cassandra服务</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="yg15"><ol class="linenums"><li class="L0"><code><span class="pln">C</span><span class="pun">:</span><span class="pln">\Users\MSI</span><span class="pun">&gt;</span><span class="pln"> D</span><span class="pun">:</span></code></li><li class="L1"><code><span class="pln">D</span><span class="pun">:</span><span class="pln">\&gt; cd D</span><span class="pun">:</span><span class="pln">\Cassandra\b</span><span class="kwd">in</span><span class="pln">\</span></code></li><li class="L2"><code><span class="pln">D</span><span class="pun">:</span><span class="pln">\Workers\Cassandra\b</span><span class="kwd">in</span><span class="pun">&gt;</span><span class="pln"> cqlsh</span></code></li></ol></pre><hr><div class="md-section-divider"></div><h2 data-anchor-id="gvlt" id="cassandra的使用"><i class="icon-th-large"></i> <strong>Cassandra的使用</strong></h2><div class="md-section-divider"></div><h3 data-anchor-id="u9g4" id="键空间操作">键空间操作</h3><p data-anchor-id="rskb">1.创建键空间。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="yldx"><ol class="linenums"><li class="L0"><code><span class="pln">cqlsh</span><span class="pun">&gt;</span><span class="pln"> create keyspace bigdata </span><span class="kwd">with</span><span class="pln"> replication </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">'class'</span><span class="pun">:</span><span class="str">'SimpleStrategy'</span><span class="pun">,</span><span class="str">'replication_factor'</span><span class="pun">:</span><span class="lit">3</span><span class="pun">};</span></code></li></ol></pre><p data-anchor-id="ro4k">验证是否创建成功</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="p9px"><ol class="linenums"><li class="L0"><code><span class="pln">cqlsh</span><span class="pun">&gt;</span><span class="pln"> describe keyspaces</span><span class="pun">;</span></code></li><li class="L1"><code><span class="pln">system_schema  system_auth  bigdata  system  system_distributed  system_traces</span></code></li></ol></pre><p data-anchor-id="xtwi">2.使用键空间</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="2agb"><ol class="linenums"><li class="L0"><code><span class="pln">cqlsh</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">use</span><span class="pln"> bigdata</span><span class="pun">;</span></code></li><li class="L1"><code><span class="pln">cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span></code></li></ol></pre><p data-anchor-id="wl5l">3.删除键空间</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="xi20"><ol class="linenums"><li class="L0"><code><span class="pln">cqlsh</span><span class="pun">&gt;</span><span class="pln"> drop keyspace bigdata</span><span class="pun">;</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="jbzo" id="表操作">表操作</h3><p data-anchor-id="bd5e">1.创建表。创建一个student表格。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="cobq"><ol class="linenums"><li class="L0"><code><span class="pln">cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> create table student</span><span class="pun">(</span></code></li><li class="L1"><code><span class="pln">               id </span><span class="kwd">int</span><span class="pln"> primary key</span><span class="pun">,</span></code></li><li class="L2"><code><span class="pln">               name text</span><span class="pun">,</span></code></li><li class="L3"><code><span class="pln">               major text</span><span class="pun">,</span></code></li><li class="L4"><code><span class="pln">               score </span><span class="kwd">int</span><span class="pun">,</span></code></li><li class="L5"><code><span class="pln">               mobile varint</span><span class="pun">);</span></code></li></ol></pre><p data-anchor-id="0dvk">查看是否创建成功</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="0yqw"><ol class="linenums"><li class="L0"><code><span class="pln">cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> student</span><span class="pun">;</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln"> id </span><span class="pun">|</span><span class="pln"> major </span><span class="pun">|</span><span class="pln"> mobile </span><span class="pun">|</span><span class="pln"> name </span><span class="pun">|</span><span class="pln"> score</span></code></li><li class="L3"><code><span class="pun">----+-------+--------+------+-------</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="pun">(</span><span class="lit">0</span><span class="pln"> rows</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="1eta">2.修改表。插入一列email属性，再删除它。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="knx4"><ol class="linenums"><li class="L0"><code><span class="pln">cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> alter table student add email text</span><span class="pun">;</span></code></li><li class="L1"><code><span class="pln">cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> student</span><span class="pun">;</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln"> id </span><span class="pun">|</span><span class="pln"> email </span><span class="pun">|</span><span class="pln"> major </span><span class="pun">|</span><span class="pln"> mobile </span><span class="pun">|</span><span class="pln"> name </span><span class="pun">|</span><span class="pln"> score</span></code></li><li class="L4"><code><span class="pun">----+-------+-------+--------+------+-------</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pun">(</span><span class="lit">0</span><span class="pln"> rows</span><span class="pun">)</span></code></li><li class="L7"><code><span class="pln">cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> alter table student drop email</span><span class="pun">;</span></code></li><li class="L8"><code><span class="pln">cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> student</span><span class="pun">;</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln"> id </span><span class="pun">|</span><span class="pln"> major </span><span class="pun">|</span><span class="pln"> mobile </span><span class="pun">|</span><span class="pln"> name </span><span class="pun">|</span><span class="pln"> score</span></code></li><li class="L1"><code><span class="pun">----+-------+--------+------+-------</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pun">(</span><span class="lit">0</span><span class="pln"> rows</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="65gi">3.删除表</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="g0bz"><ol class="linenums"><li class="L0"><code><span class="pln">cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> create table student</span><span class="pun">；</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="w8r7" id="数据操作">数据操作</h3><p data-anchor-id="4kan">1.插入数据</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="iocj"><ol class="linenums"><li class="L0"><code><span class="pln"> cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> insert </span><span class="kwd">into</span><span class="pln"> student</span><span class="pun">(</span><span class="pln">id</span><span class="pun">,</span><span class="pln">name</span><span class="pun">,</span><span class="pln">major</span><span class="pun">,</span><span class="pln">score</span><span class="pun">,</span><span class="pln">mobile</span><span class="pun">)</span><span class="pln"> values</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="str">'ZhangSan'</span><span class="pun">,</span><span class="str">'CS'</span><span class="pun">,</span><span class="lit">59</span><span class="pun">,</span><span class="lit">18880000666</span><span class="pun">);</span></code></li><li class="L1"><code><span class="pln"> cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> insert </span><span class="kwd">into</span><span class="pln"> student</span><span class="pun">(</span><span class="pln">id</span><span class="pun">,</span><span class="pln">name</span><span class="pun">,</span><span class="pln">major</span><span class="pun">,</span><span class="pln">score</span><span class="pun">,</span><span class="pln">mobile</span><span class="pun">)</span><span class="pln"> values</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="str">'LiSi'</span><span class="pun">,</span><span class="str">'AI'</span><span class="pun">,</span><span class="lit">58</span><span class="pun">,</span><span class="lit">18880000555</span><span class="pun">);</span></code></li><li class="L2"><code><span class="pln"> cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> insert </span><span class="kwd">into</span><span class="pln"> student</span><span class="pun">(</span><span class="pln">id</span><span class="pun">,</span><span class="pln">name</span><span class="pun">,</span><span class="pln">major</span><span class="pun">,</span><span class="pln">score</span><span class="pun">,</span><span class="pln">mobile</span><span class="pun">)</span><span class="pln"> values</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="str">'WangWu'</span><span class="pun">,</span><span class="str">'Null'</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="lit">18880000444</span><span class="pun">);</span></code></li><li class="L3"><code><span class="pln"> </span><span class="str">```</span></code></li><li class="L4"><code><span class="str"> 2.查询数据</span></code></li><li class="L5"><code><span class="str"> ```</span></code></li><li class="L6"><code><span class="pln"> cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> student</span><span class="pun">;</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln"> id </span><span class="pun">|</span><span class="pln"> major </span><span class="pun">|</span><span class="pln"> mobile      </span><span class="pun">|</span><span class="pln"> name     </span><span class="pun">|</span><span class="pln"> score</span></code></li><li class="L9"><code><span class="pun">----+-------+-------------+----------+-------</span></code></li><li class="L0"><code><span class="pln">  </span><span class="lit">1</span><span class="pln"> </span><span class="pun">|</span><span class="pln">    CS </span><span class="pun">|</span><span class="pln"> </span><span class="lit">18880000666</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="typ">ZhangSan</span><span class="pln"> </span><span class="pun">|</span><span class="pln">    </span><span class="lit">59</span></code></li><li class="L1"><code><span class="pln">  </span><span class="lit">2</span><span class="pln"> </span><span class="pun">|</span><span class="pln">    AI </span><span class="pun">|</span><span class="pln"> </span><span class="lit">18880000555</span><span class="pln"> </span><span class="pun">|</span><span class="pln">     </span><span class="typ">LiSi</span><span class="pln"> </span><span class="pun">|</span><span class="pln">    </span><span class="lit">58</span></code></li><li class="L2"><code><span class="pln">  </span><span class="lit">3</span><span class="pln"> </span><span class="pun">|</span><span class="pln">  </span><span class="typ">Null</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">18880000444</span><span class="pln"> </span><span class="pun">|</span><span class="pln">   </span><span class="typ">WangWu</span><span class="pln"> </span><span class="pun">|</span><span class="pln">     </span><span class="lit">2</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pun">(</span><span class="lit">3</span><span class="pln"> rows</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="mjxo">条件查询</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="mnok"><ol class="linenums"><li class="L0"><code><span class="pln">cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> student </span><span class="kwd">where</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln"> id </span><span class="pun">|</span><span class="pln"> major </span><span class="pun">|</span><span class="pln"> mobile      </span><span class="pun">|</span><span class="pln"> name </span><span class="pun">|</span><span class="pln"> score</span></code></li><li class="L3"><code><span class="pun">----+-------+-------------+------+-------</span></code></li><li class="L4"><code><span class="pln">  </span><span class="lit">2</span><span class="pln"> </span><span class="pun">|</span><span class="pln">    AI </span><span class="pun">|</span><span class="pln"> </span><span class="lit">18880000555</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="typ">LiSi</span><span class="pln"> </span><span class="pun">|</span><span class="pln">    </span><span class="lit">58</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pun">(</span><span class="lit">1</span><span class="pln"> rows</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="fjjs">3.更新数据</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="asnb"><ol class="linenums"><li class="L0"><code><span class="pln">cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> update student </span><span class="kwd">set</span><span class="pln"> score</span><span class="pun">=</span><span class="lit">100</span><span class="pln"> </span><span class="kwd">where</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span></code></li><li class="L1"><code><span class="pln">cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> student</span><span class="pun">;</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln"> id </span><span class="pun">|</span><span class="pln"> major </span><span class="pun">|</span><span class="pln"> mobile      </span><span class="pun">|</span><span class="pln"> name     </span><span class="pun">|</span><span class="pln"> score</span></code></li><li class="L4"><code><span class="pun">----+-------+-------------+----------+-------</span></code></li><li class="L5"><code><span class="pln">  </span><span class="lit">1</span><span class="pln"> </span><span class="pun">|</span><span class="pln">    CS </span><span class="pun">|</span><span class="pln"> </span><span class="lit">18880000666</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="typ">ZhangSan</span><span class="pln"> </span><span class="pun">|</span><span class="pln">    </span><span class="lit">59</span></code></li><li class="L6"><code><span class="pln">  </span><span class="lit">2</span><span class="pln"> </span><span class="pun">|</span><span class="pln">    AI </span><span class="pun">|</span><span class="pln"> </span><span class="lit">18880000555</span><span class="pln"> </span><span class="pun">|</span><span class="pln">     </span><span class="typ">LiSi</span><span class="pln"> </span><span class="pun">|</span><span class="pln">   </span><span class="lit">100</span></code></li><li class="L7"><code><span class="pln">  </span><span class="lit">3</span><span class="pln"> </span><span class="pun">|</span><span class="pln">  </span><span class="typ">Null</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">18880000444</span><span class="pln"> </span><span class="pun">|</span><span class="pln">   </span><span class="typ">WangWu</span><span class="pln"> </span><span class="pun">|</span><span class="pln">     </span><span class="lit">2</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="pun">(</span><span class="lit">3</span><span class="pln"> rows</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="ol8a">4.删除数据</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="spje"><ol class="linenums"><li class="L0"><code><span class="pln">cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">delete</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> student </span><span class="kwd">where</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">3</span><span class="pun">;</span></code></li><li class="L1"><code><span class="pln">cqlsh</span><span class="pun">:</span><span class="pln">bigdata</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> student</span><span class="pun">;</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln"> id </span><span class="pun">|</span><span class="pln"> major </span><span class="pun">|</span><span class="pln"> mobile      </span><span class="pun">|</span><span class="pln"> name     </span><span class="pun">|</span><span class="pln"> score</span></code></li><li class="L4"><code><span class="pun">----+-------+-------------+----------+-------</span></code></li><li class="L5"><code><span class="pln">  </span><span class="lit">1</span><span class="pln"> </span><span class="pun">|</span><span class="pln">    CS </span><span class="pun">|</span><span class="pln"> </span><span class="lit">18880000666</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="typ">ZhangSan</span><span class="pln"> </span><span class="pun">|</span><span class="pln">    </span><span class="lit">59</span></code></li><li class="L6"><code><span class="pln">  </span><span class="lit">2</span><span class="pln"> </span><span class="pun">|</span><span class="pln">    AI </span><span class="pun">|</span><span class="pln"> </span><span class="lit">18880000555</span><span class="pln"> </span><span class="pun">|</span><span class="pln">     </span><span class="typ">LiSi</span><span class="pln"> </span><span class="pun">|</span><span class="pln">   </span><span class="lit">100</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pun">(</span><span class="lit">2</span><span class="pln"> rows</span><span class="pun">)</span></code></li></ol></pre><hr><p data-anchor-id="avt0"><strong>以下Java和Python中使用Cassandra仅为范例参考，完成上机目标不限定具体语言和工具。</strong></p><div class="md-section-divider"></div><h2 data-anchor-id="pbvx" id="java中使用cassandra"><i class="icon-pencil"></i> <strong>Java中使用Cassandra</strong></h2><p data-anchor-id="633w">0.<strong>WARNING:</strong> <br>
1.首先需要多个驱动包，已在教学网提供。 <br>
2.在Java的Classpath中包含这些驱动包的路径，或在IDE构建项目后导入该包 <br>
3.在你的Java项目中运行如下代码(注意:确保你的Cassandra服务端正常运行中)</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="fxjj"><ol class="linenums"><li class="L0"><code class="language-Java"><span class="kwd">package</span><span class="pln"> test</span><span class="pun">;</span></code></li><li class="L1"><code class="language-Java"></code></li><li class="L2"><code class="language-Java"><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">List</span><span class="pun">;</span></code></li><li class="L3"><code class="language-Java"></code></li><li class="L4"><code class="language-Java"><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">datastax</span><span class="pun">.</span><span class="pln">driver</span><span class="pun">.</span><span class="pln">core</span><span class="pun">.</span><span class="typ">Cluster</span><span class="pun">;</span></code></li><li class="L5"><code class="language-Java"><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">datastax</span><span class="pun">.</span><span class="pln">driver</span><span class="pun">.</span><span class="pln">core</span><span class="pun">.</span><span class="typ">ResultSet</span><span class="pun">;</span></code></li><li class="L6"><code class="language-Java"><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">datastax</span><span class="pun">.</span><span class="pln">driver</span><span class="pun">.</span><span class="pln">core</span><span class="pun">.</span><span class="typ">Row</span><span class="pun">;</span></code></li><li class="L7"><code class="language-Java"><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">datastax</span><span class="pun">.</span><span class="pln">driver</span><span class="pun">.</span><span class="pln">core</span><span class="pun">.</span><span class="typ">Session</span><span class="pun">;</span></code></li><li class="L8"><code class="language-Java"></code></li><li class="L9"><code class="language-Java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">TryCassandra</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code class="language-Java"><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> args</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">){</span></code></li><li class="L1"><code class="language-Java"><span class="pln">        </span><span class="typ">Cluster</span><span class="pln"> cluster </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">  </span></code></li><li class="L2"><code class="language-Java"><span class="pln">        </span><span class="kwd">try</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span></code></li><li class="L3"><code class="language-Java"><span class="pln">            </span><span class="com">// Cluster对象是驱动程序的主入口点，用以保存Cassandra集群的已知状态。  </span></code></li><li class="L4"><code class="language-Java"><span class="pln">            cluster </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Cluster</span><span class="pun">.</span><span class="pln">builder</span><span class="pun">().</span><span class="pln">addContactPoint</span><span class="pun">(</span><span class="str">"127.0.0.1"</span><span class="pun">).</span><span class="pln">build</span><span class="pun">();</span><span class="pln">  </span></code></li><li class="L5"><code class="language-Java"><span class="pln">            </span><span class="com">// Session用来执行查询  </span></code></li><li class="L6"><code class="language-Java"><span class="pln">            </span><span class="typ">Session</span><span class="pln"> session </span><span class="pun">=</span><span class="pln"> cluster</span><span class="pun">.</span><span class="pln">connect</span><span class="pun">();</span><span class="pln">  </span></code></li><li class="L7"><code class="language-Java"><span class="pln">            </span><span class="com">// 使用execute来向Cassandra发送查询。 这将返回一个ResultSet，它是一个Row对象的集合。  </span></code></li><li class="L8"><code class="language-Java"><span class="pln">            </span><span class="com">// 在下一行，我们提取第一行（在这种情况下是唯一的一行）;  </span></code></li><li class="L9"><code class="language-Java"><span class="pln">            </span><span class="typ">ResultSet</span><span class="pln"> rs </span><span class="pun">=</span><span class="pln"> session  </span></code></li><li class="L0"><code class="language-Java"><span class="pln">                    </span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="str">"select release_version from system.local"</span><span class="pun">);</span><span class="pln">  </span></code></li><li class="L1"><code class="language-Java"><span class="pln">            </span><span class="typ">Row</span><span class="pln"> row0 </span><span class="pun">=</span><span class="pln"> rs</span><span class="pun">.</span><span class="pln">one</span><span class="pun">();</span><span class="pln">  </span></code></li><li class="L2"><code class="language-Java"><span class="pln">            </span><span class="com">// 我们从行中提取第一个（也是唯一的）列的值;  </span></code></li><li class="L3"><code class="language-Java"><span class="pln">            </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">row0</span><span class="pun">.</span><span class="pln">getString</span><span class="pun">(</span><span class="str">"release_version"</span><span class="pun">));</span><span class="pln"> </span></code></li><li class="L4"><code class="language-Java"></code></li><li class="L5"><code class="language-Java"><span class="pln">            </span><span class="com">//创建键空间  </span></code></li><li class="L6"><code class="language-Java"><span class="pln">            </span><span class="typ">String</span><span class="pln"> createKeySpaceCQL </span><span class="pun">=</span><span class="pln"> </span><span class="str">"create keyspace if not exists bigdata with replication={'class':'SimpleStrategy', 'replication_factor': 1}"</span><span class="pun">;</span><span class="pln">  </span></code></li><li class="L7"><code class="language-Java"><span class="pln">            session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="pln">createKeySpaceCQL</span><span class="pun">);</span><span class="pln">  </span></code></li><li class="L8"><code class="language-Java"></code></li><li class="L9"><code class="language-Java"><span class="pln">            </span><span class="com">//创建表  </span></code></li><li class="L0"><code class="language-Java"><span class="pln">            </span><span class="typ">String</span><span class="pln"> createTableCQL </span><span class="pun">=</span><span class="pln"> </span><span class="str">"create table if not exists bigdata.student(name varchar primary key, age int)"</span><span class="pun">;</span><span class="pln">  </span></code></li><li class="L1"><code class="language-Java"><span class="pln">            session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="pln">createTableCQL</span><span class="pun">);</span><span class="pln">             </span></code></li><li class="L2"><code class="language-Java"></code></li><li class="L3"><code class="language-Java"><span class="pln">            </span><span class="com">//插入数据  </span></code></li><li class="L4"><code class="language-Java"><span class="pln">            </span><span class="typ">String</span><span class="pln"> insertCQL </span><span class="pun">=</span><span class="pln"> </span><span class="str">"insert into bigdata.student(name,age) values('zhangsan',20)"</span><span class="pun">;</span><span class="pln">  </span></code></li><li class="L5"><code class="language-Java"><span class="pln">            session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="pln">insertCQL</span><span class="pun">);</span><span class="pln">  </span></code></li><li class="L6"><code class="language-Java"><span class="pln">            insertCQL </span><span class="pun">=</span><span class="pln"> </span><span class="str">"insert into bigdata.student(name,age) values('lisi',21)"</span><span class="pun">;</span><span class="pln">  </span></code></li><li class="L7"><code class="language-Java"><span class="pln">            session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="pln">insertCQL</span><span class="pun">);</span><span class="pln"> </span></code></li><li class="L8"><code class="language-Java"></code></li><li class="L9"><code class="language-Java"><span class="pln">            </span><span class="com">//查询,修改,删除数据  </span></code></li><li class="L0"><code class="language-Java"><span class="pln">            </span><span class="typ">String</span><span class="pln"> queryCQL </span><span class="pun">=</span><span class="pln"> </span><span class="str">"select * from bigdata.student"</span><span class="pun">;</span><span class="pln">  </span></code></li><li class="L1"><code class="language-Java"><span class="pln">            rs </span><span class="pun">=</span><span class="pln"> session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="pln">queryCQL</span><span class="pun">);</span><span class="pln">  </span></code></li><li class="L2"><code class="language-Java"><span class="pln">            </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Row</span><span class="pun">&gt;</span><span class="pln"> dataList </span><span class="pun">=</span><span class="pln"> rs</span><span class="pun">.</span><span class="pln">all</span><span class="pun">();</span><span class="pln">  </span></code></li><li class="L3"><code class="language-Java"><span class="pln">            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Row</span><span class="pln"> row </span><span class="pun">:</span><span class="pln"> dataList</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span></code></li><li class="L4"><code class="language-Java"><span class="pln">                 </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"==&gt;name: "</span><span class="pun">+</span><span class="pln"> row</span><span class="pun">.</span><span class="pln">getString</span><span class="pun">(</span><span class="str">"name"</span><span class="pun">));</span><span class="pln">  </span></code></li><li class="L5"><code class="language-Java"><span class="pln">                 </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"==&gt;age: "</span><span class="pun">+</span><span class="pln">row</span><span class="pun">.</span><span class="pln">getInt</span><span class="pun">(</span><span class="str">"age"</span><span class="pun">));</span><span class="pln">  </span></code></li><li class="L6"><code class="language-Java"><span class="pln">            </span><span class="pun">}</span><span class="pln">  </span></code></li><li class="L7"><code class="language-Java"></code></li><li class="L8"><code class="language-Java"><span class="pln">            </span><span class="com">//修改  </span></code></li><li class="L9"><code class="language-Java"><span class="pln">            </span><span class="typ">String</span><span class="pln"> updateCQL </span><span class="pun">=</span><span class="pln"> </span><span class="str">"update bigdata.student set age=22 where name='zhangsan'"</span><span class="pun">;</span><span class="pln">  </span></code></li><li class="L0"><code class="language-Java"><span class="pln">            session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="pln">updateCQL</span><span class="pun">);</span><span class="pln">  </span></code></li><li class="L1"><code class="language-Java"><span class="pln">            rs </span><span class="pun">=</span><span class="pln"> session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="pln">queryCQL</span><span class="pun">);</span><span class="pln">  </span></code></li><li class="L2"><code class="language-Java"><span class="pln">            dataList </span><span class="pun">=</span><span class="pln"> rs</span><span class="pun">.</span><span class="pln">all</span><span class="pun">();</span><span class="pln">  </span></code></li><li class="L3"><code class="language-Java"><span class="pln">            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Row</span><span class="pln"> row </span><span class="pun">:</span><span class="pln"> dataList</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span></code></li><li class="L4"><code class="language-Java"><span class="pln">                </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"==&gt;name: "</span><span class="pun">+</span><span class="pln"> row</span><span class="pun">.</span><span class="pln">getString</span><span class="pun">(</span><span class="str">"name"</span><span class="pun">));</span><span class="pln">  </span></code></li><li class="L5"><code class="language-Java"><span class="pln">            </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"==&gt;age: "</span><span class="pun">+</span><span class="pln">row</span><span class="pun">.</span><span class="pln">getInt</span><span class="pun">(</span><span class="str">"age"</span><span class="pun">));</span><span class="pln">  </span></code></li><li class="L6"><code class="language-Java"><span class="pln">            </span><span class="pun">}</span><span class="pln">  </span></code></li><li class="L7"><code class="language-Java"></code></li><li class="L8"><code class="language-Java"><span class="pln">            </span><span class="com">//删除数据  </span></code></li><li class="L9"><code class="language-Java"><span class="pln">            </span><span class="typ">String</span><span class="pln"> deleteCQL </span><span class="pun">=</span><span class="pln"> </span><span class="str">"delete from bigdata.student where name='zhangsan'"</span><span class="pun">;</span><span class="pln">  </span></code></li><li class="L0"><code class="language-Java"><span class="pln">            session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="pln">deleteCQL</span><span class="pun">);</span><span class="pln">  </span></code></li><li class="L1"><code class="language-Java"><span class="pln">            rs </span><span class="pun">=</span><span class="pln"> session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="pln">queryCQL</span><span class="pun">);</span><span class="pln">  </span></code></li><li class="L2"><code class="language-Java"><span class="pln">            dataList </span><span class="pun">=</span><span class="pln"> rs</span><span class="pun">.</span><span class="pln">all</span><span class="pun">();</span><span class="pln">  </span></code></li><li class="L3"><code class="language-Java"><span class="pln">            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Row</span><span class="pln"> row </span><span class="pun">:</span><span class="pln"> dataList</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span></code></li><li class="L4"><code class="language-Java"><span class="pln">                </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"==&gt;name: "</span><span class="pun">+</span><span class="pln"> row</span><span class="pun">.</span><span class="pln">getString</span><span class="pun">(</span><span class="str">"name"</span><span class="pun">));</span><span class="pln">  </span></code></li><li class="L5"><code class="language-Java"><span class="pln">                </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"==&gt;age: "</span><span class="pun">+</span><span class="pln">row</span><span class="pun">.</span><span class="pln">getInt</span><span class="pun">(</span><span class="str">"age"</span><span class="pun">));</span><span class="pln">  </span></code></li><li class="L6"><code class="language-Java"><span class="pln">            </span><span class="pun">}</span><span class="pln">  </span></code></li><li class="L7"><code class="language-Java"></code></li><li class="L8"><code class="language-Java"><span class="pln">        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">finally</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span></code></li><li class="L9"><code class="language-Java"><span class="pln">            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cluster </span><span class="pun">!=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">)</span><span class="pln">  </span></code></li><li class="L0"><code class="language-Java"><span class="pln">                </span><span class="com">//关闭集群</span></code></li><li class="L1"><code class="language-Java"><span class="pln">                cluster</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span><span class="pln">   </span></code></li><li class="L2"><code class="language-Java"><span class="pln">       </span><span class="pun">}</span><span class="pln">  </span></code></li><li class="L3"><code class="language-Java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L4"><code class="language-Java"></code></li><li class="L5"><code class="language-Java"><span class="pun">}</span></code></li><li class="L6"><code class="language-Java"></code></li><li class="L7"><code class="language-Java"></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="kz1q" id="python中使用cassandra"><i class="icon-pencil"></i> <strong>Python中使用Cassandra</strong></h2><p data-anchor-id="yqmt">1.安装驱动。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="rwtl"><ol class="linenums"><li class="L0"><code><span class="pln">pip install cassandra</span><span class="pun">-</span><span class="pln">driver</span></code></li></ol></pre><p data-anchor-id="veei">2.在你的Python项目中运行如下代码</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="vtvi"><ol class="linenums"><li class="L0"><code class="language-Python"><span class="kwd">from</span><span class="pln"> cassandra</span><span class="pun">.</span><span class="pln">cluster </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Cluster</span></code></li><li class="L1"><code class="language-Python"></code></li><li class="L2"><code class="language-Python"><span class="pln">cluster </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Cluster</span><span class="pun">([</span><span class="str">'127.0.0.1'</span><span class="pun">])</span></code></li><li class="L3"><code class="language-Python"><span class="pln">session </span><span class="pun">=</span><span class="pln"> cluster</span><span class="pun">.</span><span class="pln">connect</span><span class="pun">()</span></code></li><li class="L4"><code class="language-Python"><span class="pln">session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="str">"create keyspace if not exists bigdata with replication={'class':'SimpleStrategy', 'replication_factor': 1}"</span><span class="pun">)</span></code></li><li class="L5"><code class="language-Python"><span class="pln">session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="str">'use bigdata'</span><span class="pun">)</span></code></li><li class="L6"><code class="language-Python"></code></li><li class="L7"><code class="language-Python"><span class="kwd">try</span><span class="pun">:</span></code></li><li class="L8"><code class="language-Python"><span class="pln">    session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="str">"create table student (name varchar primary key, age int)"</span><span class="pun">)</span></code></li><li class="L9"><code class="language-Python"><span class="kwd">except</span><span class="pun">:</span></code></li><li class="L0"><code class="language-Python"><span class="pln">    </span><span class="kwd">pass</span></code></li><li class="L1"><code class="language-Python"></code></li><li class="L2"><code class="language-Python"><span class="com">#插入数据</span></code></li><li class="L3"><code class="language-Python"><span class="pln">session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="str">"insert into bigdata.student(name,age) values('zhangsan',20)"</span><span class="pun">)</span></code></li><li class="L4"><code class="language-Python"><span class="pln">session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="str">"insert into bigdata.student(name,age) values('lisi',21)"</span><span class="pun">)</span></code></li><li class="L5"><code class="language-Python"><span class="pln">rs </span><span class="pun">=</span><span class="pln"> session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="str">"select * from bigdata.student"</span><span class="pun">)</span></code></li><li class="L6"><code class="language-Python"><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> rs</span><span class="pun">:</span></code></li><li class="L7"><code class="language-Python"><span class="pln">   </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">i</span><span class="pun">.</span><span class="pln">name</span><span class="pun">+</span><span class="str">":"</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">i</span><span class="pun">.</span><span class="pln">age</span><span class="pun">))</span></code></li><li class="L8"><code class="language-Python"></code></li><li class="L9"><code class="language-Python"><span class="com">#修改数据</span></code></li><li class="L0"><code class="language-Python"><span class="pln">rs</span><span class="pun">=</span><span class="pln">session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="str">"update bigdata.student set age=22 where name='zhangsan'"</span><span class="pun">);</span></code></li><li class="L1"><code class="language-Python"><span class="pln">rs </span><span class="pun">=</span><span class="pln"> session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="str">"select * from bigdata.student"</span><span class="pun">)</span></code></li><li class="L2"><code class="language-Python"><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> rs</span><span class="pun">:</span></code></li><li class="L3"><code class="language-Python"><span class="pln">   </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">i</span><span class="pun">.</span><span class="pln">name </span><span class="pun">+</span><span class="pln"> </span><span class="str">":"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">i</span><span class="pun">.</span><span class="pln">age</span><span class="pun">))</span></code></li><li class="L4"><code class="language-Python"></code></li><li class="L5"><code class="language-Python"><span class="com">#删除数据</span></code></li><li class="L6"><code class="language-Python"><span class="pln">session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="str">"delete from bigdata.student where name='zhangsan'"</span><span class="pun">);</span></code></li><li class="L7"><code class="language-Python"><span class="pln">rs </span><span class="pun">=</span><span class="pln"> session</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="str">"select * from bigdata.student"</span><span class="pun">)</span></code></li><li class="L8"><code class="language-Python"><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> rs</span><span class="pun">:</span></code></li><li class="L9"><code class="language-Python"><span class="pln">   </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">i</span><span class="pun">.</span><span class="pln">name </span><span class="pun">+</span><span class="pln"> </span><span class="str">":"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">i</span><span class="pun">.</span><span class="pln">age</span><span class="pun">))</span></code></li></ol></pre></div>
</body>
</html>